nth(sort(c(1,4,2,3,5,7,3,4)),2)
library(tidyverse)
library(nycflights13)
n(flights)
summarise(flights, n)
colnames(flights)
flights %>% group_by(origin) %>% summarise(count=n())
rowwise(commodity)
a <- data.frame(n = c("a", "b", "c"), x = c("d","e","f"))
a
mutate(a, samp = sample(n,x))
mutate(rowwise(a), samp = sample(n,x))
mutate(a, samp = sample(c(n,x), size=1))
mutate(a, samp = sample(c(n,x), size=1))
mutate(a, samp = sample(c(n,x), size=1))
mutate(a, samp = sample(c(n,x), size=1))
mutate(rowwise(a), samp = sample(c(n,x), size=1))
mutate(rowwise(a), samp = sample(c(n,x), size=1))
range(c(1,4,2,3,1,2,1,23))
flights %>% filter(!is.na(dep_delay)) %>%
group_by(origin) %>%
summarise(rr=range(dep_delay, na.rm=TRUE))
df(r = range(c(1,4,2,32,3,2)))
data.frame(r = range(c(1,4,2,32,3,2)))
flights %>% filter(!is.na(dep_delay)) %>%
group_by(origin) %>%
summarise(rr=range(dep_delay, na.rm=TRUE))
colnames(flights)
?select
select(flights, contains("delay"))
flights %>% filter(dep_delay>=88) %>% group_by(year, month, day)
flights %>% filter(dep_delay>=88) %>% group_by(year, month, day) %>% summarise(n())
?n
flights %>% filter(dep_delay>=100) %>% group_by(year, month, day) %>% summarise(n())
flights %>% filter(dep_delay>=120) %>% group_by(year, month, day) %>% summarise(n())
flights %>% filter(dep_delay>=200) %>% group_by(year, month, day) %>% summarise(n())
flights %>% filter(dep_delay>=300) %>% group_by(year, month, day) %>% summarise(n())
flights %>% filter(dep_delay>=500) %>% group_by(year, month, day) %>% summarise(n())
flights %>% filter(dep_delay>=500) %>% group_by(year, month, day) %>% summarise(count = n()) %>% arrange(desc(count))
flights %>% filter(dep_delay>=900) %>% group_by(year, month, day) %>% summarise(count = n()) %>% arrange(desc(count))
flights %>% filter(dep_delay>=800) %>% group_by(year, month, day) %>% summarise(count = n()) %>% arrange(desc(count))
qnorm(0.5)
qnorm(1)
qnorm(-1)
qnorm(0.95)
pnorm(0.95)
pnorm(0.95)
pnorm(1)
pnorm(0)
x <- seq(-3,3,0.01)
plot(x, pnorm(x))
plot(x, dnorm(x))
plot(x, dnorm(x), type="l")
plot(x, dnorm(x), type="l", col="red")
plot(x, dnorm(x), type="l", col="red")
```{r}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(jsonlite)
rest_json <- stream_in(file("../data/restaurants_dataset.json"))
head(rest_json)
head(rest_json$grades)
head(rest_json)$grades
rest_json <- stream_in(file("../data/restaurants_dataset.json")) %>%
unnest(cols=c(address,grades))
View(commodity)
rest_json
rest_json$coord
?rm
?mutate
rest_json$coord[1]
rest_json$coord[[1]]
rest_json$coord[[2]]
rest_json$coord[2]
rest_json$coord[8]
rest_json$coord[100]
rest_json$coord[1000]
?select
q1_tbl <- mutate(rest_json, lat=coord[1], long=coord[2], .before=street) %>%
select(!coord)
q1_tbl
?drop
q1_tbl <- mutate(rest_json, lat=coord[][1], long=coord[][2], .before=street) %>%
select(!coord)
q1_tbl
q1_tbl <- mutate(rest_json, lat=coord[[]][1], long=coord[[]][2], .before=street) %>%
select(!coord)
q1_tbl
rest_json$coord
dim(rest_json)
dim(rest_json$coord)
length(rest_json$coord)
?mutate
lapply(coord, function(x), x[2])
lapply(coord, function(x) x[2])
lapply(rest_json$coord, function(x) x[2])
sapply(rest_json$coord, function(x) x[2])
lat <- sapply(rest_json$coord, function(x) x[1])
long <- sapply(rest_json$coord, function(x) x[2])
q1_tbl <- mutate(rest_json,
lat=sapply(coord, function(x) x[1]),
long=sapply(coord, function(x) x[2]),
.before=street) %>%
select(!coord)
q1_tbl
q1_tbl <- mutate(rest_json,
lat=sapply(coord, function(x) x[2]),
long=sapply(coord, function(x) x[1]),
.before=street) %>%
select(!coord)
q1_tbl
range(rest_json$lat)
range(rest_json$long)
range(q1_tbl$lat)
range(q1_tbl$long)
range(c(1,2))
summary(q1_tbl$lat)
?range
range(q1_tbl$lat, na.rm=TRUE)
range(q1_tbl$long, na.rm=TRUE)
q1_tbl %>% filter(lat < 0)
q1_tbl
negative_lat <- q1_tbl %>% filter(lat < 0)
negative_lat
?filter
summary(q1_tbl$long)
negative_lat <- q1_tbl %>% filter(lat < 0 & long > 0)
negative_lat
mistakes <- q1_tbl %>% filter(lat < 0 & long > 0)
mistakes
summary(group_by(q1_tbl, street), lat=lat, long=long)
summarise(group_by(q1_tbl, street), lat=lat, long=long)
summarise(group_by(q1_tbl, street), lat=mean(lat), long=mean(long))
summarise(group_by(q1_tbl, street), lat=mean(lat), long=mean(long)) %>% filter (long > 0)
summarise(group_by(q1_tbl, name), lat=mean(lat), long=mean(long)) %>% filter (long > 0)
summarise(group_by(q1_tbl, name), lat=any(lat < 0), long=any(long > 0)) %>% filter (long > 0)
summarise(group_by(q1_tbl, name), neg_lat=any(lat < 0), pos_long=any(long > 0))
mistakes <- q1_tbl %>% filter(lat < 0 & long > 0)
summarise(group_by(q1_tbl, name), neg_lat=any(lat < 0), pos_long=any(long > 0))
mistakes2 <- q1_tbl %>%
group_by(name) %>%
summarise(false_lat = any(lat <0), false_long = any (long > 0)) %>%
select(false_long == TRUE || false_lat == TRUE)
mistakes <- q1_tbl %>% filter(lat < 0 & long > 0)
summarise(group_by(q1_tbl, name), neg_lat=any(lat < 0), pos_long=any(long > 0))
mistakes2 <- q1_tbl %>%
group_by(name) %>%
summarise(false_lat = any(lat <0), false_long = any (long > 0)) %>%
select(false_long == TRUE | false_lat == TRUE)
mistakes <- q1_tbl %>% filter(lat < 0 & long > 0)
summarise(group_by(q1_tbl, name), neg_lat=any(lat < 0), pos_long=any(long > 0))
mistakes2 <- q1_tbl %>%
group_by(name) %>%
summarise(false_lat = any(lat <0), false_long = any(long > 0)) %>%
select(false_long == TRUE | false_lat == TRUE)
mistakes <- q1_tbl %>% filter(lat < 0 & long > 0)
summarise(group_by(q1_tbl, name), neg_lat=any(lat < 0), pos_long=any(long > 0))
mistakes2 <- q1_tbl %>%
group_by(name) %>%
summarise(false_lat = any(lat <0), false_long = any(long > 0)) %>%
filter(false_long == TRUE | false_lat == TRUE)
mistakes2
q1_tbl
american_manhattan <- q1_tbl %>%
filter(borough == Manhattan & cuisine == American)
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & cuisine == "American")
american_manhattan
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan")
american_manhattan
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(jsonlite)
library(stringr)
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican"))
american_manhattan
american_manhattan <- q1_tbl %>%
group_by(name) %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican"))
american_manhattan
american_manhattan <- q1_tbl %>%
group_by(name) %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
summarise(name)
american_manhattan <- q1_tbl %>%
group_by(name) %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
summarise(name=name)
american_manhattan
```{R}
american_manhattan <- q1_tbl %>%
group_by(name) %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican"))
american_manhattan
american_manhattan <- q1_tbl %>%
group_by(name) %>%
summarise(name=name) %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican"))
american_manhattan <- q1_tbl %>%
group_by(name) %>%
summarise(name=name, borough=borough, cuisine=cuisine) %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican"))
american_manhattan
american_manhattan <- q1_tbl %>%
group_by(name) %>%
summarise(name=name, borough=borough, cuisine=cuisine)
american_manhattan
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(name) %>%
summarise(name)
american_manhattan
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(name) %>%
summarise()
american_manhattan
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(name) %>%
summarise()
length(american_manhattan)
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(name) %>%
summarise()
dim(american_manhattan)
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(name) %>%
summarise()
# Number of restaurants in Manhattan that serve American
dim(american_manhattan)
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(name) %>%
summarise()
# Number of restaurants in Manhattan that serve American
dim(american_manhattan)[1]
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(restaurant_id) %>%
summarise()
# Number of restaurants in Manhattan that serve American
dim(american_manhattan)[1]
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(restaurant_id)
american_manhattan
?mode
?max
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(restaurant_id) %>%
summarise(name = max(name))
# Number of restaurants in Manhattan that serve American
dim(american_manhattan)[1]
american_manhattan
max(c("a", "b", "c"))
max(c("a", "b", "a"))
max(table(c("a", "b", "a")))
table(c("a", "b", "a"))
american_manhattan <- q1_tbl %>%
filter(borough == "Manhattan" & str_detect(cuisine, "[Aa]merican")) %>%
group_by(restaurant_id) %>%
summarise(name = max(name))
# Number of restaurants in Manhattan that serve American
dim(american_manhattan)[1]
mistakes <- q1_tbl %>% filter(lat < 0 & long > 0)
summarise(group_by(q1_tbl, name), neg_lat=any(lat < 0), pos_long=any(long > 0))
mistakes2 <- q1_tbl %>%
group_by(restaurant_id) %>%
summarise(false_lat = any(lat <0), false_long = any(long > 0)) %>%
filter(false_long == TRUE | false_lat == TRUE)
mistakes2
summary(c("a", "b", "b"))
summary(c("a", "b", "b", "b"))
summary(c(1, 3, 4, 4))
mean(c("a", "b", "b"))
max(c("a", "b", "b"))
max(c("a", "b", "a"))
min(c("a", "b", "a"))
max(c("a", "b", "a")) == min(c("a"))
"a" == "a"
q1_tbl %>%
group_by(name, restaurant_id) %>%
summarise(name=max(name), n=n()) %>%
arrange(n)
q1_tbl %>%
group_by(restaurant_id) %>%
summarise(name=max(name), n=n()) %>%
arrange(n)
grading <- q1_tbl %>%
group_by(restaurant_id) %>%
summarise(name=max(name), n=n()) %>%
arrange(n)
grading
grading <- q1_tbl %>%
group_by(restaurant_id) %>%
summarise(name=max(name), n=n()) %>%
arrange(desc(n))
grading
?all
x <- c("A", "B", "A")
all(x=="A")
all(c("A", "A", "A")=="A")
c("A")[TRUE]
c("A", "B")[TRUE]
c("A", "B", "CC")[TRUE]
q1_tbl
select(q1_tbl, date())
select(q1_tbl, date)
?difftime
range(q1_tbl$date)
range(q1_tbl$date)[1] - range(q1_tbl$date)[2]
min(range(q1_tbl$date))
min(range(q1_tbl$date)[1] - range(q1_tbl$date)[2])
difftime(q1_tbl$date)
shortest_time <- q1_tbl %>%
group_by(restaurant_id) %>%
arrange(desc(date))
summarise(shortest_time, min(date))
?difftime
difftime(range(q1_tbl$date)[1], range(q1_tbl$date)[2])
difftime(range(q1_tbl$date)[2], range(q1_tbl$date)[1])
abs(difftime(range(q1_tbl$date)[2], range(q1_tbl$date)[1]))
c(1,2,3) - lag(c(1,2,3))
min(c(1,2,3) - lag(c(1,2,3)))
min(c(1,2,3) - lag(c(1,2,3)), na.rm=TRUE)
min(NA, na.rm=TRUE)
min(c(NA, NA), na.rm=TRUE)
shortest_time <- q1_tbl %>%
group_by(restaurant_id) %>%
filter(n() > 1) %>%
arrange(desc(date)) %>%
mutate(interval = abs(difftime(date-lag(date)))) %>%
summarise(name=max(name), shortest_interval = min(interval, na.rm=TRUE))
filter(q1_tbl,date=="30075445")
filter(q1_tbl,restaurant_id=="30075445")
select(filter(q1_tbl,restaurant_id=="30075445"), 5:11)
shortest_time <- q1_tbl %>%
group_by(restaurant_id) %>%
filter(n() > 1) %>%
arrange(desc(date)) %>%
mutate(interval = abs(difftime(date-lag(date)))) %>%
summarise(name=max(name), shortest_interval = min(interval, na.rm=TRUE))
class(q1_tbl$date)
?time1
shortest_time <- q1_tbl %>%
group_by(restaurant_id) %>%
filter(n() > 1) %>%
arrange(desc(date)) %>%
mutate(interval = abs(difftime(date,lag(date)))) %>%
summarise(name=max(name), shortest_interval = min(interval, na.rm=TRUE))
shortest_time
arrange(shortest_time, shortest_interval)
filter(q1_tbl, restaurant_id==50001362)
filter(q1_tbl, restaurant_id==50001362)$date
?quantile
quantile(c(1,2,3,4,5,6,7,8))
quantile(c(1,2,3,4,5,6,7,8))[1]
quantile(c(1,2,3,4,5,6,7,8))[2]
quantile(c(1,2,3,4,5,6,7,8))[4]
2nd <-1
2nd <- 1
summary_score <- q1_tbl %>%
group_by(grade) %>%
summarise(count = n(),
min = quantile(score)[1],
qtl1 = quantile(score)[2],
med = quantile(score)[3],
qtl3 = quantile(score)[4],
max = quantile(score)[5])
summary_score <- q1_tbl %>%
group_by(grade) %>%
summarise(count = n(),
min = quantile(score, na.rm=TRUE)[1],
qtl1 = quantile(score, na.rm=TRUE)[2],
med = quantile(score, na.rm=TRUE)[3],
qtl3 = quantile(score, na.rm=TRUE)[4],
max = quantile(score, na.rm=TRUE)[5])
summary_score
?across
across_stuff <- q1_tbl %>%
group_by(restaurant_id) %>%
across(c(grade, score), ~ max(.x))
across_stuff <- q1_tbl %>%
group_by(restaurant_id) %>%
across(c(grade, score), function(x) max(x))
across_stuff <- q1_tbl %>%
group_by(restaurant_id) %>%
across(c( score), ~ max(.x))
across_stuff <- q1_tbl %>%
group_by(restaurant_id) %>%
mutate(across(c(grade score), ~ max(.x)))
across_stuff <- q1_tbl %>%
group_by(restaurant_id) %>%
mutate(across(c(grade ,score), ~ max(.x)))
across_stuff
across_stuff$grade
across_stuff <- q1_tbl %>%
group_by(restaurant_id) %>%
mutate(across(c(grade ,score), list(~ max(.x), ~ min(.x)) ))
across_stuff
across_stuff <- q1_tbl %>%
group_by(restaurant_id) %>%
mutate(across(c(grade ,score), list(~ min(.x), ~ max(.x)) )) %>%
summarise(grade_min = min(grade_1), grade_max = max(grade_2),
score_min= min(score_1), score_max = max(score_2))
across_stuff
a <- c(1:2)
a[3]
a[5]
a[1:5]
?months
months(as.Date("2022-03-03"))
?strptime
months_stuff <- q1_tbl %>%
mutate(month = months(date)) %>%
group_by(borough, month) %>%
summarise(n = n())
months_stuff
months_stuff <- q1_tbl %>%
mutate(month = months(date)) %>%
group_by(c(borough,month)) %>%
summarise(n = n())
?group_by
months_stuff <- q1_tbl %>%
mutate(month = months(date)) %>%
group_by(borough,month) %>%
summarise(n = n())
?summarise
months_stuff <- q1_tbl %>%
mutate(month = months(date)) %>%
group_by(borough,month) %>%
summarise(n = n(),.groups="drop")
months_stuff
print(months_stuff, n=72)
?recode
a <- c(1,2,3,4,5,1)
recode(a, 1=12)
a <- c("a", "b") %>% recode(a=123)
a
x <- c("a", "b")
recode(x, a=123)
x
recode(x, a=123, b=1234)
# FUCK
asian <- q1_tbl %>%
recode(cuisine, Vietnamese/Cambodian/Malaysia = "Asian",
# FUCK
asian <- q1_tbl %>%
recode(cuisine, "Vietnamese/Cambodian/Malaysia" = "Asian",
Thai = "Asian",
Chinese = "Asian")
# FUCK
asian <- q1_tbl %>%
recode(q1_tbl$cuisine, "Vietnamese/Cambodian/Malaysia" = "Asian",
Thai = "Asian",
Chinese = "Asian")
recode(q1_tbl$cuisine, "Vietnamese/Cambodian/Malaysia" = "Asian",
Thai = "Asian",
Chinese = "Asian")
?nth
a <- c(1,2,3,4,5)
nth(a,1)
nth(a,4)
nth(a,33)
grades2 <- q1_tbl %>%
group_by(restaurant_id) %>%
filter(n() >= 2)
grades2 <- q1_tbl %>%
group_by(restaurant_id) %>%
filter(n() >= 2) %>%
filter(nth(1)=="C" & nth(2)=="A")
grades2 <- q1_tbl %>%
group_by(restaurant_id) %>%
filter(n() >= 2) %>%
filter(nth(grades,1)=="C" & nth(grades,2)=="A")
grades2 <- q1_tbl %>%
group_by(restaurant_id) %>%
filter(n() >= 2) %>%
filter(nth(grade,1)=="C" & nth(grade,2)=="A")
grades2
select(q1_tbl, 9:12)
select(grades2, 9:12)
gradesA <- q1_tbl %>%
group_by(restaurant_id) %>%
mutate(gradeA = all(grade=="A")) %>%
summarise(name = nth(name), gradeA=gradeA) %>%
filter(gradeA == TRUE)
gradesA <- q1_tbl %>%
group_by(restaurant_id) %>%
mutate(gradeA = all(grade=="A")) %>%
summarise(name = nth(name,1), gradeA=gradeA) %>%
filter(gradeA == TRUE)
gradesA
gradesA <- q1_tbl %>%
group_by(restaurant_id) %>%
summarise(name = nth(name,1), gradeA=all(grade=="A")) %>%
filter(gradeA == TRUE)
gradesA
q1_tbl
matrix <- matrix(c(1,2,3,4))
matrix
matrix(c(1,2,3,4))
matrix(c(1,2,3,4,6,6,4))
matrix
apply(matrix, 1, mean)
apply(matrix, 2, mean)
